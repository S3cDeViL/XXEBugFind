/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package bugfind.xxe;

import bugfind.sootadapters.MethodDefinition;
import java.util.ArrayList;
import java.util.List;
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

/**
 *
 * @author Mikosh
 */
@XmlRootElement
@XmlAccessorType (XmlAccessType.FIELD)
public class VulnerabilityDefinitionItem {
    @XmlElement (name = "MethodDefinition")
    private MethodDefinition methodDefinition;
    @XmlElement(name="VulnerabilityMitigationItem")
    private List<VulnerabilityMitigationItem> mitigationList;

    public VulnerabilityDefinitionItem() {}
    
    public VulnerabilityDefinitionItem(MethodDefinition methodDefinition, List<VulnerabilityMitigationItem> mitigationList) {
        this.methodDefinition = methodDefinition;
        this.mitigationList = (mitigationList == null) ? new ArrayList<VulnerabilityMitigationItem>() : mitigationList;
    }
    
    public VulnerabilityDefinitionItem(MethodDefinition methodDefinition) {
        this(methodDefinition, null);
    }

    public MethodDefinition getMethodDefinition() {
        return methodDefinition;
    }

    public List<VulnerabilityMitigationItem> getMitigationList() {
        return mitigationList;
    }    

    public void setMitigationList(List<VulnerabilityMitigationItem> mitigationList) {
        this.mitigationList = mitigationList;
    }
    
    public boolean addMitigationItem(VulnerabilityMitigationItem vmi) {
        return this.mitigationList.add(vmi);
    }
    
    public void addMitigationItemsFromList (List<VulnerabilityMitigationItem> vmiList) {
        for (VulnerabilityMitigationItem vmi : vmiList) {
            this.mitigationList.add(vmi);
        }        
    }
}
